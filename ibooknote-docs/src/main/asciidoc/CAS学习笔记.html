<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<title>CAS学习笔记</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
:not(pre)>code.nobreak{word-wrap:normal}
:not(pre)>code.nowrap{white-space:nowrap}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
td.tableblock>.content>:last-child.sidebarblock{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article">
<div id="header">
<h1>CAS学习笔记</h1>
</div>
<div id="content">
<div class="sect1">
<h2 id="_1_cas介绍">1. CAS介绍</h2>
<div class="sectionbody">
<div class="paragraph">
<p>CAS&#8201;&#8212;&#8201;Central Authentication Service</p>
</div>
<div class="paragraph">
<p>核心组件：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>CAS Server&#8201;&#8212;&#8201;CAS服务器端，为CAS客户提供认证、授权，分发TGT、ST凭证</p>
</li>
<li>
<p>Service Management&#8201;&#8212;&#8201;CAS服务管理，管理CAS的服务注册信息，与CAS服务器分开单独部署，但共享同一个服务注册信息存储</p>
</li>
<li>
<p>CAS Client&#8201;&#8212;&#8201;CAS客户端（web/app），需要使用CAS服务器做为单点登录验证和授权的客户端应用</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_1_1_部署方式">1.1. 部署方式</h3>
<div class="paragraph">
<p><strong>CAS Server</strong></p>
</div>
<div class="paragraph">
<p>通过 cas-overlay 方式部署，无需修改cas-overlay 代码，只修改相关配置即可，项目地址：</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/apereo/cas-overlay-template" class="bare">https://github.com/apereo/cas-overlay-template</a></p>
</div>
<div class="paragraph">
<p>配置测试域名：cas.example.org</p>
</div>
<div class="paragraph">
<p><strong>配置SSL</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>keytool -genkey -alias cas -keyalg RSA -validity 999 \
    -keystore /etc/cas/thekeystore -ext san=dns:cas.example.org
Enter keystore password: changeit
Re-enter new password: changeit
What is your first and last name?
  [Unknown]:  cas.example.org
What is the name of your organizational unit?
  [Unknown]:  test
What is the name of your organization?
  [Unknown]:  test
What is the name of your City or Locality?
  [Unknown]:  test
What is the name of your State or Province?
  [Unknown]:  test
What is the two-letter country code for this unit?
  [Unknown]:  CN
Is CN=cas.example.org, OU=test, O=test, L=test, ST=test, C=CN correct?
  [no]:  yes</pre>
</div>
</div>
<div class="paragraph">
<p>修改/etc/hosts:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>127.0.0.1	cas.example.org</pre>
</div>
</div>
<div class="paragraph">
<p>导出证书，并导入到Java虚拟机目录：</p>
</div>
<div class="listingblock">
<div class="content">
<pre># Export the certificate into a file
sudo keytool -export -file /etc/cas/config/cas.crt -keystore /etc/cas/thekeystore -alias cas

# Import the certificate into the global keystore
sudo keytool -import -file /etc/cas/config/cas.crt -alias cas -keystore $JAVA_HOME/lib/security/cacerts</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Service Management</strong></p>
</div>
<div class="paragraph">
<p>通过 cas-management-overlay 方式部署，项目地址：</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/apereo/cas-management-overlay" class="bare">https://github.com/apereo/cas-management-overlay</a></p>
</div>
<div class="paragraph">
<p><strong>CAS Client</strong></p>
</div>
<div class="paragraph">
<p>通过在项目中引入 cas-client 依赖，项目地址：</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/apereo/java-cas-client" class="bare">https://github.com/apereo/java-cas-client</a></p>
</div>
<div class="paragraph">
<p>Gradle依赖：</p>
</div>
<div class="listingblock">
<div class="content">
<pre>implementation 'org.jasig.cas.client:cas-client-support-springboot:3.6.0'</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_2_cas_overlay_cas服务器">2. CAS-overlay CAS服务器</h2>
<div class="sectionbody">
<div class="paragraph">
<p>CAS定制化改造原则：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>避免对软件内部做临时修改（ad-hoc）</p>
</li>
<li>
<p>避免手动修改核心配置组件（如Spring、Spring Webflow）</p>
</li>
<li>
<p>避免对deployment做一次性bug修复，应该提交issue</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>官方建议：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Bug修改和小的改进应该属于CAS软件核心，而不是使用者的部署，确保上报每一个issue、contribute fixes和补丁。尽量和CAS社区功能解决issue。</p>
</li>
<li>
<p>CAS的内部核心组件很难修改，如果用例的功能的配置和实现确实需要修改软件的内部核心，应该和CAS社区讨论，尝试将其直接构建到CAS软件中。</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>只在必要时才对部署配置进行修改。</p>
</div>
<div class="paragraph">
<p>cas-overlay 项目启动后可通过以下地址访问：</p>
</div>
<div class="paragraph">
<p><a href="https://cas.example.org:8443/cas/login" class="bare">https://cas.example.org:8443/cas/login</a></p>
</div>
<div class="paragraph">
<p>设置登录用户名、密码（/etc/cas/config/cas.properties）：</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>cas.authn.accept.users=sungness::sungness</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>默认登录用户名密码： casuser / Mellon，设置上面的账号密码之后，默认账号密码即失效。</p>
</div>
<div class="paragraph">
<p>正式部署时必须将其关闭</p>
</div>
<div class="paragraph">
<p>启动客户端应用后，访问客户端页面报错：</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Application Not Authorized to Use CAS

The application you attempted to authenticate to is not authorized to use CAS. This usually indicates that the application is not registered with CAS, or its authorization policy defined in its registration record prevents it from leveraging CAS functionality, or it's malformed and unrecognized by CAS. Contact your CAS administrator to learn how you might register and integrate your application with CAS.</pre>
</div>
</div>
<div class="paragraph">
<p>解决办法</p>
</div>
<div class="listingblock">
<div class="content">
<pre>I solved issue myself, The issue was with the serviceId not mapped correctly in the client table of the CAS database.

It took two weeks to understand the complete CAS system and resolve the issue. But Someone having the same issue can directly follow the below steps (Assuming CAS 5.1 version deployed on tomcat +linux)

Check your .json files placed under /etc/cas/services
Check your .jwks files places under /etc/cas/jwks folder
Check the clientId and ClientSecret matches in .json , .jwks and in CAS Database- Client table
Check the serviceID mapped in .json,.jwks and in your CAS Database,client table
All the best.</pre>
</div>
</div>
<div class="sect2">
<h3 id="_2_1_cas_properties">2.1. CAS Properties</h3>
<div class="paragraph">
<p><a href="https://apereo.github.io/cas/6.2.x/configuration/Configuration-Properties.html" class="bare">https://apereo.github.io/cas/6.2.x/configuration/Configuration-Properties.html</a></p>
</div>
<div class="paragraph">
<p>不要把所有配置都加加到CAS配置中，只需要挑选需要的。属性名称可以多种形式配置：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>cas.someProperty</p>
</li>
<li>
<p>cas.some-property</p>
</li>
<li>
<p>cas.some_property</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_2_1_1_普通配置属性">2.1.1. 普通配置属性</h4>
<div class="paragraph">
<p><a href="https://apereo.github.io/cas/6.2.x/configuration/Configuration-Properties-Common.html" class="bare">https://apereo.github.io/cas/6.2.x/configuration/Configuration-Properties-Common.html</a></p>
</div>
</div>
<div class="sect3">
<h4 id="_2_1_2_属性验证">2.1.2. 属性验证</h4>
<div class="paragraph">
<p>CAS启动时自动验证。</p>
</div>
</div>
<div class="sect3">
<h4 id="_2_1_3_自定义设置">2.1.3. 自定义设置</h4>
<div class="listingblock">
<div class="content">
<pre>cas.custom.properties.[property-name]=[property-value]</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_2_1_4_配置存储">2.1.4. 配置存储</h4>
<div class="paragraph">
<p><strong>单机模式</strong></p>
</div>
<div class="paragraph">
<p>单机模式时，只有一个server实例，可以通过目录或文件定位配置：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>指定目录&#8201;&#8212;&#8201;cas.standalone.configurationDirectory 如果不指定，默认查找 /etc/cas/config;/opt/cas/config;/var/cas/config</p>
</li>
<li>
<p>指定文件&#8201;&#8212;&#8201;cas.standalone.configurationFile</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Spring Cloud</strong></p>
</div>
<div class="paragraph">
<p>使用src/main/resources/bootstrap.properties中配置的服务器查找配置</p>
</div>
<div class="paragraph">
<p>参考：
<a href="https://apereo.github.io/cas/6.2.x/configuration/Configuration-Server-Management.html" class="bare">https://apereo.github.io/cas/6.2.x/configuration/Configuration-Server-Management.html</a></p>
</div>
<div class="paragraph">
<p>Spring Cloud支持的配置服务器包括：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Native</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre># spring.profiles.active=native

# The configuration directory where CAS should monitor to locate settings.
# spring.cloud.config.server.native.search-locations=file:///etc/cas/config</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Git仓库</p>
</li>
<li>
<p>MongoDB</p>
</li>
<li>
<p>Amazon S3</p>
</li>
<li>
<p>JDBC</p>
</li>
<li>
<p>REST</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre># cas.spring.cloud.rest.url=
# cas.spring.cloud.rest.basic-auth-username=
# cas.spring.cloud.rest.basic-auth-password=
# cas.spring.cloud.rest.method=
# cas.spring.cloud.rest.headers=Header1:Value1;Header2:Value2</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_2_1_5_配置安全">2.1.5. 配置安全</h4>
<div class="paragraph">
<p>敏感信息加密：
<a href="https://apereo.github.io/cas/6.2.x/configuration/Configuration-Properties-Security.html" class="bare">https://apereo.github.io/cas/6.2.x/configuration/Configuration-Properties-Security.html</a></p>
</div>
</div>
<div class="sect3">
<h4 id="_2_1_6_监控检查">2.1.6. 监控检查</h4>
<div class="ulist">
<ul>
<li>
<p>内存</p>
</li>
<li>
<p>系统（CPU、负载、堆）</p>
</li>
<li>
<p>session健康检查，tickets、SSO session使用情况</p>
</li>
<li>
<p>JDBC数据库连接</p>
</li>
<li>
<p>LDAP 连接池</p>
</li>
<li>
<p>MongoDB连接</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_3_service_management">3. Service Management</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="https://apereo.github.io/cas/6.3.x/services/Service-Management.html" class="bare">https://apereo.github.io/cas/6.3.x/services/Service-Management.html</a></p>
</div>
<div class="paragraph">
<p>CAS服务管理功能允许CAS服务器管理员声明和配置哪些服务（CAS客户端）可以使用CAS。服务管理的核心组件是：service registry 服务注册，用于存储一个或多个已注册的服务，包括它们的元数据，可以完成以下一些行为：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Authorized services - 控制哪些服务可以参与到CAS SSO session</p>
</li>
<li>
<p>Forced authentication - 提供管理验证，强制验证</p>
</li>
<li>
<p>Attribute release - 属性发布，为服务提供用户的详细信息，用于授权和个性化</p>
</li>
<li>
<p>Proxy control -</p>
</li>
<li>
<p>Theme control - 为特定服务定义代替的CAS样式</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>service-registry相关的配置属性：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>cas.service-registry.*</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>属性相关连接：</p>
</div>
<div class="paragraph">
<p><a href="https://apereo.github.io/cas/6.3.x/configuration/Configuration-Properties.html#service-registry" class="bare">https://apereo.github.io/cas/6.3.x/configuration/Configuration-Properties.html#service-registry</a></p>
</div>
<div class="sect2">
<h3 id="_3_1_管理端点">3.1. 管理端点</h3>
<div class="ulist">
<ul>
<li>
<p>registeredServices&#8201;&#8212;&#8201;查询或删除注册的服务，GET、DELETE</p>
</li>
<li>
<p>exportRegisterdServices&#8201;&#8212;&#8201;导出ZIP格式的已注册服务</p>
</li>
<li>
<p>importRegisterdServices&#8201;&#8212;&#8201;导入服务定义</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_3_2_服务管理web应用">3.2. 服务管理Web应用</h3>
<div class="paragraph">
<p>服务管理webapp是一个独立的web应用，可以作为CAS的辅助单独部署，提供了一个GUI界面用于管理服务注册数据。管理web应用必须与CAS server共享同一份注册配置，以便整个系统能够加载相同的服务数据。</p>
</div>
<div class="paragraph">
<p>管理webapp安装说明：</p>
</div>
<div class="paragraph">
<p><a href="https://apereo.github.io/cas/6.3.x/services/Installing-ServicesMgmt-Webapp.html" class="bare">https://apereo.github.io/cas/6.3.x/services/Installing-ServicesMgmt-Webapp.html</a></p>
</div>
<div class="paragraph">
<p>Overlay Installation</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/apereo/cas-management-overlay" class="bare">https://github.com/apereo/cas-management-overlay</a></p>
</div>
</div>
<div class="sect2">
<h3 id="_3_3_注册服务registered_services">3.3. 注册服务（Registered Services）</h3>
<div class="paragraph">
<p>注册服务信息包括以下元数据：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>id&#8201;&#8212;&#8201;必须，唯一标识即，必须是数值型</p>
</li>
<li>
<p>name&#8201;&#8212;&#8201;必须，服务名称，不超过255个字符</p>
</li>
<li>
<p>description&#8201;&#8212;&#8201;可选，关于服务的描述信息，255个字符以下</p>
</li>
<li>
<p>informationUrl&#8201;&#8212;&#8201;可选，指向服务信息指南的URL地址</p>
</li>
<li>
<p>privacyUrl&#8201;&#8212;&#8201;可选，指向服务隐私政策的URL地址</p>
</li>
<li>
<p>redirectUrl&#8201;&#8212;&#8201;可选，认证通过后跳转回的应用URL地址</p>
</li>
<li>
<p>logo&#8201;&#8212;&#8201;指向服务的Logo图片地址，图片将与服务描述和名称一起显示在登录页面。可以是指向CAS web应用images目录的相对路径，也可以是完整路径</p>
</li>
<li>
<p>serviceId&#8201;&#8212;&#8201;必须，描述一个logical service的正则表达式。一个逻辑服务定义一个或多个用于定位服务的URLs。URl模式定义必须加倍小心，因为它可能导致安全漏洞</p>
</li>
<li>
<p>theme&#8201;&#8212;&#8201;可选，当需要一个ticket时，样式名称可用于自定义CAS UI。values可以使用Spring Expression Language语法</p>
</li>
<li>
<p>proxyPolicy&#8201;&#8212;&#8201;确定服务是否能够代理身份验证</p>
</li>
<li>
<p>evaluationOrder&#8201;&#8212;&#8201;确定注册服务的相对顺序。当两个服务URL表达式指向同一个服务时，该参数用于评估有限使用哪个，作为内部排序的一个因素</p>
</li>
<li>
<p>authenticationPolicy&#8201;&#8212;&#8201;认证政策，可以作为补充，也可以覆盖全局认证engine</p>
</li>
<li>
<p>attributeReleasePolicy&#8201;&#8212;&#8201;用于描述可发布给应用的属性的政策，过滤逻辑</p>
</li>
<li>
<p>logoutType&#8201;&#8212;&#8201;定义当logout协议开始时，如何对待服务</p>
<div class="ulist">
<ul>
<li>
<p>LogoutType.BACK_CHANNEL</p>
</li>
<li>
<p>LogoutType.FRONT_CHANNEL</p>
</li>
<li>
<p>LogoutType.NONE</p>
</li>
</ul>
</div>
</li>
<li>
<p>responseType&#8201;&#8212;&#8201;定义CAS对这个服务如何响应</p>
</li>
<li>
<p>usernameAttributeProvider&#8201;&#8212;&#8201;确定哪个值作为“username”返回给应用</p>
</li>
<li>
<p>accessStrategy&#8201;&#8212;&#8201;用于定义服务访问规则的策略配置</p>
</li>
<li>
<p>publicKey&#8201;&#8212;&#8201;与服务相关的公钥，用于授权请求时，对回应信息进行加密</p>
</li>
<li>
<p>logoutUrl&#8201;&#8212;&#8201;服务用于接收logout请求的URL</p>
</li>
<li>
<p>properties&#8201;&#8212;&#8201;与服务相关的额外元数据，key/value对形式。可以用于向服务定义中注入自定义字段，以便扩展模块使用</p>
</li>
<li>
<p>multifactorPolicy&#8201;&#8212;&#8201;通常用于多步认证时，描述服务认证的政策</p>
</li>
<li>
<p>contacts&#8201;&#8212;&#8201;服务所有者相关的联系方式</p>
</li>
<li>
<p>matchingStrategy&#8201;&#8212;&#8201;指定认证请求匹配服务定义的策略</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Service Type</strong></p>
</div>
<div class="paragraph">
<p>以上属性可用于所有普通服务定义，用于特殊协议的额外服务类型属性可参考相应指南。</p>
</div>
<div class="sect3">
<h4 id="_3_3_1_服务访问策略">3.3.1. 服务访问策略</h4>

</div>
<div class="sect3">
<h4 id="_3_3_2_代理认证政策">3.3.2. 代理认证政策</h4>

</div>
<div class="sect3">
<h4 id="_3_3_3_required_authentication">3.3.3. Required Authentication</h4>

</div>
<div class="sect3">
<h4 id="_3_3_4_tags_properties">3.3.4. Tags &amp; Properties</h4>

</div>
<div class="sect3">
<h4 id="_3_3_5_contacts_owners">3.3.5. Contacts &amp; Owners</h4>

</div>
<div class="sect3">
<h4 id="_3_3_6_过期政策">3.3.6. 过期政策</h4>

</div>
<div class="sect3">
<h4 id="_3_3_7_匹配策略">3.3.7. 匹配策略</h4>

</div>
<div class="sect3">
<h4 id="_3_3_8_存储">3.3.8 存储</h4>
<div class="paragraph">
<p>CAS可用以下方式存储服务元数据信息：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Memory&#8201;&#8212;&#8201;将服务定义XML存储在内存中。如果修改，需要CAS重新打包、服务器重启</p>
</li>
<li>
<p>JSON&#8201;&#8212;&#8201;将服务定义存储在JSON文件中。HA高可用部署方式需要同步服务定义</p>
</li>
<li>
<p>YAML&#8201;&#8212;&#8201;将服务定义存储在YAML文件中。HA高可用部署方式需要同步服务定义</p>
</li>
<li>
<p>GIT&#8201;&#8212;&#8201;将服务定义存储在GIT仓库中。HA部署的候选方案</p>
</li>
<li>
<p>MongoDB&#8201;&#8212;&#8201;将服务定义存储在MongoDB中。HA部署的候选方案</p>
</li>
<li>
<p>Redis&#8201;&#8212;&#8201;将服务定义存储在Redis中。HA部署的候选方案</p>
</li>
<li>
<p>LDAP&#8201;&#8212;&#8201;将服务定义存储在目录服务器中。HA部署的候选方案</p>
</li>
<li>
<p>JPA 将服务定义存储在关系型数据库中。HA部署的候选方案</p>
</li>
<li>
<p>Couchbase&#8201;&#8212;&#8201;将服务定义存储在Couchbase中。HA部署的候选方案</p>
</li>
<li>
<p>CouchDB&#8201;&#8212;&#8201;将服务定义存储在CouchDB中。HA部署的候选方案</p>
</li>
<li>
<p>&#8230;&#8203;</p>
</li>
<li>
<p>REST&#8201;&#8212;&#8201;以REST API方式实现自己的服务注册。HA部署的候选方案</p>
</li>
<li>
<p>Custom&#8201;&#8212;&#8201;使用CAS APIs扩展实现自己的服务注册。HA部署的候选方案</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Memory存储服务注册信息</strong></p>
</div>
<div class="paragraph">
<p>以Spring Bean的方式注入到上下文环境，不适合使用服务管理webapp，因为它没有持久化数据。只适合硬编码配置，且无需UI管理的方式使用</p>
</div>
<div class="listingblock">
<div class="content">
<pre>@Configuration("myConfiguration")
public class MyConfiguration {

  @Bean
  public List inMemoryRegisteredServices() {
      final List services = new ArrayList&lt;&gt;();
      final RegexRegisteredService service = new RegexRegisteredService();
      ...
      services.add(service);
      return services;
  }
}</pre>
</div>
</div>
<div class="paragraph">
<p>也可以在启动时通过默认JSON服务定义自动初始化，服务定义文件存储在：</p>
</div>
<div class="paragraph">
<p><em>classpath:src/main/resources/services</em></p>
</div>
<div class="paragraph">
<p><strong>JSON服务注册</strong></p>
</div>
<div class="paragraph">
<p>开启依赖：</p>
</div>
<div class="listingblock">
<div class="content">
<pre>implementation "org.apereo.cas:cas-server-support-json-service-registry:${casServerVersion}</pre>
</div>
</div>
<div class="paragraph">
<p>通过本地系统资源定位JSON服务定义，可以通过参指定JSON资源文件存储的路径</p>
</div>
<div class="listingblock">
<div class="content">
<pre># cas.service-registry.json.location=classpath:/services</pre>
</div>
</div>
<div class="paragraph">
<p>文件命名规则：</p>
</div>
<div class="paragraph">
<p><em>JSON fileName = serviceName + "-" + serviceNumericId + ".json"</em></p>
</div>
<div class="paragraph">
<p><strong>YAML服务注册</strong></p>
</div>
<div class="paragraph">
<p>开启依赖：</p>
</div>
<div class="listingblock">
<div class="content">
<pre>implementation "org.apereo.cas:cas-server-support-yaml-service-registry:${casServerVersion}</pre>
</div>
</div>
<div class="paragraph">
<p>通过本地系统资源定位YAML服务定义，可以通过参指定YAML资源文件存储的路径</p>
</div>
<div class="listingblock">
<div class="content">
<pre># cas.service-registry.yaml.location=classpath:/services</pre>
</div>
</div>
<div class="paragraph">
<p>文件命名规则：</p>
</div>
<div class="paragraph">
<p><em>YAML fileName = serviceName + "-" + serviceNumericId + ".yml"</em></p>
</div>
<div class="paragraph">
<p><strong>如何选择存储方案</strong></p>
</div>
<div class="paragraph">
<p>选择标准如下：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>选择比较擅长的技术，有足够的技能解决问题、扩展</p>
</li>
<li>
<p>选择的技术不应该强制将CAS配置绑定到集群中任何单个的服务器或节点上，因为这将自动扩展问题和人工的付出</p>
</li>
<li>
<p>选择一种适合自己的网络或防火墙配置的技术</p>
</li>
<li>
<p>选择一种能够达到性能和压力测试要求的技术</p>
</li>
<li>
<p>选择一种尽量不依赖外部处理、系统和人工的技术</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_00_cas文档转换">00. cas文档转换</h2>
<div class="sectionbody">
<div class="paragraph">
<p>使用国内镜像下载安装 gitbook</p>
</div>
<div class="listingblock">
<div class="content">
<pre>npm install --registry=https://registry.npm.taobao.org gitbook-cli -g</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>cd docs/cas-server-documentation
gitbook install
gitbook serve</pre>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2021-01-11 22:15:46 +0800
</div>
</div>
</body>
</html>